{% extends "tool_base.html" %}
{% from 'macros.html' import share %}

{% block title %}{{ _('WTFcsv results') }}{% endblock %}

{% block custom_css %}
	<link href="{{ url_for('static', filename='css/wtfcsv-results.scss.css') }}" rel="stylesheet" type="text/css">
{% endblock %}

{% block nav %}
	{% include 'tool_nav.html' %}
{% endblock %}

{% block body %}
<div class="container">
	<div class="row">
		<div class="col-md-12">
			<h2> 
			{{ngettext("You have %(num)s row of data.", "You have %(num)s rows of data.", results['row_count'])}}
			{{_("Here's a bit of info about each one:")}}
			</h2>
		</div>
	</div>
	{% set column_count = results['columns']|length %}
	{% for c in range(column_count) %}
		{% set col=results['columns'][c] %}
		{% if c % 3 == 0 %}<div class="row">{% endif %}
		<div class="col-md-4">
			<div class="column-info">
				<h3>{{col['name']}}</h3>
				<ul>
					{% set type_name=col['type'] %}
					{% if 'index' in col %}
						<li>{{_("Column %d" % col['index'])}}</li>
					{% endif %}
					{% if 'type' in col %}
						{% set is_number = False %}
						{% if type_name == 'unicode' %}
							{% set type_name=_('text') %}
						{% endif %}
						{% if type_name == 'int' or type_name == 'float' or type_name == 'long' or type_name == 'complex' %}
							{% set is_number = True %}
							{% set type_name = _('numbers') %}
						{% endif %}
						{% if type_name == 'datetime' %}
							{% set type_name = _('dates and times') %}
						{% endif %}
						{% if type_name == 'time' %}
							{% set type_name = _('times') %}
						{% endif %}
						<li>{{_("This column is full of")}} {{ type_name }}</li>
					{% endif %}
					{% if 'values' in col %}
						<li>{{_("The unique values in this column are:")}}
						<ul>
							{% for val in col['values'] %}<li><em>{{val}}</em></li>{% endfor %}
						</ul>
						</li>
					{% elif 'most_freq_values' in col %}
						<li>{{ _("The most frequent values in this column are:") }}
							<ul>
								{% for val in col['most_freq_values'] %}
									{% if is_number %}
									<li><em>{{ val['value'] | replace("_", ".") }}</em><em> ({{ val['count'] }})</em></li>
									{% else %}
										<li><em>{{ val['value'] }}</em><em> ({{ val['count'] }})</em></li>
									{% endif %}
								{% endfor %}
							</ul>
						</li>
					{% endif %}
					{% if 'max_str_len' in col %}
						<li>{{ _("The longest word has %d characters" % col['max_str_len']) }}</li>
					{% endif %}
					{% if 'min' in col %}
						<li>
						{% if type_name == 'datetime' %}
							{{ _('The earliest date is') }}
						{% else %}
							{{_("The smallest number is") }} 
						{% endif %} <em>{{col['min']}}</em></li>
					{% endif %}
					{% if 'max' in col %}
						<li>
						{% if type_name == 'datetime' %}
							{{ _('The latest date is') }}
						{% else %}
							{{_("The biggest number is") }}
						{% endif %} <em>{{col['max']}}</em></li>
					{% endif %}
					{% if 'sum' in col %}
						<li>{{_("The total is") }} <em>{{col['sum']}}</em></li>
					{% endif %}
					{% if 'mean' in col %}
						<li>{{_("The average is") }} <em>{{col['mean']}}</em></li>
					{% endif %}
					{% if 'median' in col %}
						<li>{{_("The median is") }} <em>{{col['median']}}</em></li>
					{% endif %}
					{% if 'stdev' in col %}
						<li>{{_("The standard deviation is") }} <em>{{col['stdev']}}</em></li>
					{% endif %}
					{% if 'nulls' in col %}
						<!-- <li>{{col['nulls']}}</li> -->
					{% endif %}
					{% if 'freq' in col %}
						<li>{{col['freq']}}</li>
					{% endif %}
					{% if 'len' in col %}
						<li>{{_("The longest string is <em>%d</em> characters" % col['len']) }}</li>
					{% endif %}
				</ul>
			</div>
		</div>
		{% if (c+1) % 3 == 0 %}</div>{% endif %}
	{% endfor %}
	{% if column_count % 3 > 0 %}</div>{% endif %}
	<div class="row">
		<div class="col-md-12">
			{# share() #}
		</div>
	</div>
</div>
{% endblock %}